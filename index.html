<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>فروشگاه PayPop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #0d0f1c;
            color: #e0e7ff;
            overflow-x: hidden;
        }
        .container-bg {
            background-image: radial-gradient(at 0% 0%, #1a234f 0%, #0d0f1c 50%),
                              radial-gradient(at 100% 100%, #1a234f 0%, #0d0f1c 50%);
        }
        .aurora-glow {
            box-shadow: 0 0 15px rgba(124, 58, 237, 0.5), 0 0 30px rgba(168, 85, 247, 0.4);
            transition: all 0.3s ease-in-out;
        }
        .btn-aurora {
            background-image: linear-gradient(135deg, #a855f7, #7c3aed);
            transition: all 0.3s ease;
        }
        .btn-aurora:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.5);
        }
        .card-bg {
            background: #111424;
            border: 1px solid #2d3748;
            transition: transform 0.3s ease;
        }
        .card-bg:hover {
            transform: translateY(-5px);
        }
        .neon-border {
            border-image: linear-gradient(45deg, #7c3aed, #a855f7, #c084fc, #a855f7) 1;
        }
        .hidden-section {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .visible-section {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        .mobile-menu {
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
        }
        .mobile-menu.open {
            transform: translateX(0);
        }
    </style>
</head>
<body class="rtl">
    <!-- Header -->
    <header class="bg-[#111424] text-white p-4 fixed w-full top-0 z-50">
        <div class="container mx-auto flex justify-between items-center px-4">
            <!-- Logo Section -->
            <div class="flex items-center">
                <img src="https://placehold.co/40x40/7c3aed/FFFFFF?text=PP" alt="PayPop Logo" class="h-10 w-10 rounded-full mr-2 aurora-glow">
                <span class="text-2xl font-bold text-violet-400">MineShop</span>
            </div>
            <!-- Desktop Nav -->
            <nav class="hidden md:flex space-x-4 items-center">
                <a href="#products" id="nav-products-link" class="hover:text-violet-400 transition-colors">محصولات</a>
                <a href="#cart" id="nav-cart-link" class="hover:text-violet-400 transition-colors hidden">سبد خرید</a>
                <a href="#orders" id="nav-orders-link" class="hover:text-violet-400 transition-colors hidden">سفارشات من</a>
                <a href="#admin" id="nav-admin-link" class="hover:text-violet-400 transition-colors hidden">پنل ادمین</a>
                <a href="#" id="login-link" class="bg-violet-600 hover:bg-violet-700 text-white font-bold py-2 px-4 rounded-full transition-colors">ورود</a>
                <a href="#" id="register-link" class="border border-violet-600 hover:bg-violet-600 text-white font-bold py-2 px-4 rounded-full transition-colors">ثبت نام</a>
                <a href="#" id="logout-link" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full transition-colors hidden">خروج</a>
            </nav>
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-btn" class="md:hidden text-white focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                </svg>
            </button>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="mobile-menu fixed top-0 right-0 w-64 h-full bg-[#0d0f1c] shadow-lg z-40 md:hidden p-4 pt-20">
        <nav class="flex flex-col space-y-4">
            <a href="#products" id="nav-products-link-mobile" class="text-white hover:text-violet-400 transition-colors py-2">محصولات</a>
            <a href="#cart" id="nav-cart-link-mobile" class="text-white hover:text-violet-400 transition-colors py-2 hidden">سبد خرید</a>
            <a href="#orders" id="nav-orders-link-mobile" class="text-white hover:text-violet-400 transition-colors py-2 hidden">سفارشات من</a>
            <a href="#admin" id="nav-admin-link-mobile" class="text-white hover:text-violet-400 transition-colors py-2 hidden">پنل ادمین</a>
            <a href="#" id="login-link-mobile" class="bg-violet-600 hover:bg-violet-700 text-white text-center font-bold py-2 px-4 rounded-full transition-colors">ورود</a>
            <a href="#" id="register-link-mobile" class="border border-violet-600 hover:bg-violet-600 text-white text-center font-bold py-2 px-4 rounded-full transition-colors">ثبت نام</a>
            <a href="#" id="logout-link-mobile" class="bg-red-600 hover:bg-red-700 text-white text-center font-bold py-2 px-4 rounded-full transition-colors hidden">خروج</a>
        </nav>
    </div>

    <!-- Main Content -->
    <main class="container-bg min-h-screen pt-24 pb-12">
        <!-- Hero Section -->
        <section id="hero" class="text-center py-20 px-4">
            <h1 class="text-5xl md:text-6xl font-extrabold text-white leading-tight">
                با رنک‌های <span class="text-violet-400 aurora-glow">ویژه</span>
                تجربه ماینکرافتت رو متحول کن!
            </h1>
            <p class="mt-4 text-xl md:text-2xl text-gray-300">
                میتوانید بهترین رنک ها را خریداری بکنید PayPop برای بهتر شدن در سرور
            </p>
        </section>

        <!-- Login & Register Section -->
        <section id="login-register" class="py-16 px-4 visible-section">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
                <!-- Login/Register Form Card -->
                <div class="card-bg p-8 rounded-3xl shadow-lg border-2 neon-border">
                    <!-- Login Form -->
                    <div id="login-form-card">
                        <h2 class="text-3xl font-bold text-center text-white mb-6">ورود به حساب</h2>
                        <form id="login-form">
                            <div class="mb-4">
                                <label for="username-login" class="block text-gray-300 mb-1">نام کاربری:</label>
                                <input type="text" id="username-login" name="username" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white placeholder-gray-500" placeholder="نام کاربری خود را وارد کنید">
                            </div>
                            <div class="mb-6">
                                <label for="password-login" class="block text-gray-300 mb-1">رمز عبور:</label>
                                <input type="password" id="password-login" name="password" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white placeholder-gray-500" placeholder="رمز عبور خود را وارد کنید">
                            </div>
                            <button type="submit" class="btn-aurora w-full text-white font-bold py-3 px-6 rounded-full">
                                ورود
                            </button>
                        </form>
                        <p class="text-center text-gray-400 mt-4">
                            <a href="#" id="show-register" class="text-violet-400 hover:underline">حساب کاربری ندارید؟ ثبت نام کنید.</a>
                        </p>
                        <p class="text-center text-gray-400 mt-2">
                             <a href="#" id="show-recovery" class="text-violet-400 hover:underline">فراموشی رمز عبور؟</a>
                        </p>
                    </div>

                    <!-- Register Form (hidden initially) -->
                    <div id="register-form-card" class="hidden">
                        <h2 class="text-3xl font-bold text-center text-white mb-6">ساخت حساب کاربری</h2>
                        <form id="register-form">
                            <div class="mb-4">
                                <label for="username-register" class="block text-gray-300 mb-1">نام کاربری:</label>
                                <input type="text" id="username-register" name="username" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white placeholder-gray-500" placeholder="نام کاربری خود را وارد کنید">
                            </div>
                            <div class="mb-6">
                                <label for="password-register" class="block text-gray-300 mb-1">رمز عبور:</label>
                                <input type="password" id="password-register" name="password" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white placeholder-gray-500" placeholder="رمز عبور خود را وارد کنید">
                            </div>
                            <button type="submit" class="btn-aurora w-full text-white font-bold py-3 px-6 rounded-full">
                                ثبت نام
                            </button>
                        </form>
                        <p class="text-center text-gray-400 mt-4">
                            قبلاً ثبت نام کرده‌اید؟ <a href="#" id="show-login" class="text-violet-400 hover:underline">وارد شوید.</a>
                        </p>
                    </div>

                    <!-- Password Recovery Form (hidden initially) -->
                    <div id="recovery-form-card" class="hidden">
                        <h2 class="text-3xl font-bold text-center text-white mb-6">بازیابی رمز عبور</h2>
                        <form id="recovery-form">
                            <div class="mb-4">
                                <label for="username-recovery" class="block text-gray-300 mb-1">نام کاربری:</label>
                                <input type="text" id="username-recovery" name="username" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white placeholder-gray-500" placeholder="نام کاربری خود را وارد کنید">
                            </div>
                            <div class="mb-4">
                                <label for="backup-code" class="block text-gray-300 mb-1">کد پشتیبان:</label>
                                <input type="text" id="backup-code" name="backupCode" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white placeholder-gray-500" placeholder="کد پشتیبان خود را وارد کنید">
                            </div>
                             <div class="mb-6">
                                <label for="new-password" class="block text-gray-300 mb-1">رمز عبور جدید:</label>
                                <input type="password" id="new-password" name="newPassword" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white placeholder-gray-500" placeholder="رمز عبور جدید را وارد کنید">
                            </div>
                            <button type="submit" class="btn-aurora w-full text-white font-bold py-3 px-6 rounded-full">
                                تغییر رمز عبور
                            </button>
                        </form>
                         <p class="text-center text-gray-400 mt-4">
                            <a href="#" id="back-to-login" class="text-violet-400 hover:underline">بازگشت به صفحه ورود</a>
                        </p>
                    </div>
                </div>

                <!-- Server Info Card -->
                <div class="card-bg p-8 rounded-3xl shadow-lg border-2 neon-border flex flex-col items-center justify-center">
                    <img src="https://placehold.co/250x150/000000/FFFFFF?text=Minecraft" alt="Minecraft Logo" class="rounded-lg mb-4">
                    <h2 class="text-3xl font-bold text-center text-white mb-2">سرور PayPop</h2>
                    <p class="text-center text-gray-400">
                        بهترین سرور ماینکرافت ایران با گیممودهای متنوع!
                    </p>
                    <ul class="text-center text-gray-300 mt-4 list-disc list-inside">
                        <li>گیم مودهای: Red-Dead, Skyloot, SMP, Valyball</li>
                        <li>آدرس سرور: <span class="text-violet-400 font-bold">PayPop.tgmc.ir</span></li>
                    </ul>
                    <div class="flex items-center space-x-4 space-x-reverse mt-6">
                         <!-- Placeholder for Discord -->
                         <a href="#" id="discord-link" target="_blank" class="text-violet-400 hover:text-violet-300 transition-colors">
                             <img src="https://placehold.co/40x40/5865F2/FFFFFF?text=D" alt="Discord" class="rounded-full">
                         </a>
                         <!-- Placeholder for Rubika -->
                         <a href="#" id="rubika-link" target="_blank" class="text-violet-400 hover:text-violet-300 transition-colors">
                             <img src="https://placehold.co/40x40/FF0000/FFFFFF?text=R" alt="Rubika" class="rounded-full">
                         </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Panel (Initially Hidden) -->
        <section id="admin-panel" class="hidden-section py-16 px-4">
            <h2 class="text-4xl font-bold text-center text-white mb-12">پنل مدیریت</h2>
            <div class="max-w-3xl mx-auto card-bg p-8 rounded-3xl shadow-lg border-2 neon-border">
                
                <h3 class="text-2xl font-bold text-white mb-6">افزودن محصول جدید</h3>
                <form id="add-product-form" class="space-y-4">
                    <div>
                        <label for="product-name" class="block text-gray-300">نام محصول:</label>
                        <input type="text" id="product-name" name="name" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" required>
                    </div>
                    <div>
                        <label for="product-price" class="block text-gray-300">قیمت (تومان):</label>
                        <input type="number" id="product-price" name="price" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" required>
                    </div>
                    <div>
                        <label for="product-image" class="block text-gray-300">لینک تصویر محصول:</label>
                        <input type="url" id="product-image" name="image" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" placeholder="https://placehold.co/600x400/000000/FFFFFF?text=Product">
                    </div>
                    <div>
                        <label for="product-description" class="block text-gray-300">توضیحات محصول:</label>
                        <textarea id="product-description" name="description" rows="4" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" required></textarea>
                    </div>
                    <div>
                        <label for="product-type" class="block text-gray-300">نوع محصول:</label>
                        <select id="product-type" name="type" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white">
                            <option value="normal">عادی</option>
                            <option value="featured">ویژه</option>
                            <option value="discounted">تخفیف‌خورده</option>
                        </select>
                    </div>
                    <div>
                        <label for="product-plans" class="block text-gray-300">پلن‌ها (با کاما جدا کنید):</label>
                        <input type="text" id="product-plans" name="plans" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" placeholder="مثال: ۱ ماهه, ۳ ماهه, نامحدود">
                    </div>
                    <button type="submit" class="btn-aurora w-full text-white font-bold py-3 px-6 rounded-full mt-4">
                        افزودن محصول
                    </button>
                </form>

                <div class="mt-12">
                    <h3 class="text-2xl font-bold text-white mb-6">مدیریت محصولات</h3>
                    <div id="product-management-container" class="space-y-4">
                        <!-- Products for management will be loaded here -->
                    </div>
                </div>

                <div class="mt-12">
                    <h3 class="text-2xl font-bold text-white mb-6">مدیریت سفارشات</h3>
                    <div id="admin-orders-container" class="space-y-4">
                        <!-- Admin orders will be loaded here -->
                    </div>
                </div>

                <div class="mt-12">
                    <h3 class="text-2xl font-bold text-white mb-4">تنظیمات سایت</h3>
                    <form id="admin-settings-form" class="space-y-4">
                        <div>
                            <label for="admin-card-number" class="block text-gray-300">شماره کارت برای تسویه حساب:</label>
                            <input type="text" id="admin-card-number" name="cardNumber" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" required>
                        </div>
                        <div>
                            <label for="discord-url" class="block text-gray-300">لینک دیسکورد:</label>
                            <input type="url" id="discord-url" name="discordUrl" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" required>
                        </div>
                        <div>
                            <label for="rubika-url" class="block text-gray-300">لینک روبیکا:</label>
                            <input type="url" id="rubika-url" name="rubikaUrl" class="w-full p-3 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" required>
                        </div>
                        <button type="submit" class="btn-aurora w-full text-white font-bold py-3 px-6 rounded-full mt-4">
                            بهروزرسانی تنظیمات
                        </button>
                    </form>
                </div>

            </div>
        </section>

        <!-- Products Section (Initially Hidden) -->
        <section id="products" class="hidden-section py-16 px-4">
            <h2 class="text-4xl font-bold text-center text-white mb-8">محصولات</h2>
            <div class="flex flex-col md:flex-row justify-center items-center mb-8 space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse">
                <div class="text-white text-lg font-semibold">مرتب‌سازی:</div>
                <select id="price-filter" class="p-2 rounded-lg bg-[#0d0f1c] border border-violet-600 text-white focus:outline-none focus:ring-2 focus:ring-violet-400">
                    <option value="default">پیش‌فرض</option>
                    <option value="desc">بیشترین قیمت</option>
                    <option value="asc">کمترین قیمت</option>
                </select>
            </div>

            <div id="featured-products" class="mb-12">
                <h3 class="text-3xl font-bold text-violet-400 text-center mb-8">محصولات ویژه</h3>
                <div id="featured-products-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
                    <!-- Featured products will be loaded here by JS -->
                </div>
            </div>

            <div id="discounted-products" class="mb-12">
                <h3 class="text-3xl font-bold text-violet-400 text-center mb-8">محصولات تخفیف‌خورده</h3>
                <div id="discounted-products-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
                    <!-- Discounted products will be loaded here by JS -->
                </div>
            </div>

            <div id="all-products">
                <h3 class="text-3xl font-bold text-white text-center mb-8">تمام محصولات</h3>
                <div id="products-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
                    <!-- All products will be loaded here by JS -->
                </div>
            </div>
        </section>
        
        <!-- Shopping Cart Section (Initially Hidden) -->
        <section id="shopping-cart" class="hidden-section py-16 px-4">
            <h2 class="text-4xl font-bold text-center text-white mb-12">سبد خرید</h2>
            <div id="cart-container" class="max-w-3xl mx-auto space-y-6">
                <!-- Cart items will be loaded here by JS -->
                <p id="empty-cart-message" class="text-center text-gray-400 text-xl hidden">سبد خرید شما خالی است.</p>
            </div>
            <div id="cart-total" class="max-w-3xl mx-auto mt-8 text-right text-3xl font-bold text-white">
                مجموع: <span id="total-price">0</span> تومان
            </div>
            <div class="max-w-3xl mx-auto mt-8 text-center">
                <button id="checkout-btn" class="btn-aurora text-white font-bold py-3 px-12 rounded-full hidden">
                    تکمیل سفارش
                </button>
            </div>
        </section>

        <!-- Order Management Section (Initially Hidden) -->
        <section id="order-management" class="hidden-section py-16 px-4">
            <div id="checkout-card" class="max-w-xl mx-auto card-bg p-8 rounded-3xl shadow-lg border-2 neon-border">
                <h2 class="text-3xl font-bold text-center text-white mb-6">ارسال رسید پرداخت</h2>
                <p class="text-center text-gray-400 mb-6">
                    لطفا مبلغ <span id="final-price" class="font-bold text-violet-400"></span> تومان را به شماره کارت زیر واریز کنید.
                    <br>
                    <span id="admin-card-number-display" class="text-violet-400 font-bold">شماره کارت ادمین: ۱۲۳۴-۵۶۷۸-۹۱۰۱-۱۱۲۲</span>
                </p>
                <form id="order-form">
                    <div class="mb-4">
                        <label for="minecraft-username" class="block text-gray-300">نام کاربری ماینکرافت:</label>
                        <input type="text" id="minecraft-username" name="minecraftUsername" class="w-full mt-1 p-2 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" placeholder="نام کاربری ماینکرافت خود را وارد کنید" required>
                    </div>
                    <div class="mb-4">
                        <label for="order-code" class="block text-gray-300">کد سفارش:</label>
                        <input type="text" id="order-code" name="orderCode" class="w-full mt-1 p-2 rounded-lg bg-[#0d0f1c] border border-violet-600 focus:outline-none focus:ring-2 focus:ring-violet-400 text-white" required>
                    </div>
                    <div class="mb-4">
                        <label for="receipt-image" class="block text-gray-300">تصویر فیش واریزی:</label>
                        <input type="file" id="receipt-image" name="receiptImage" class="w-full mt-1 p-2 rounded-lg bg-[#0d0f1c] text-white" accept="image/*" required>
                    </div>
                    <button type="submit" class="btn-aurora w-full text-white font-bold py-3 px-6 rounded-full mt-4">
                        ارسال سفارش
                    </button>
                </form>
            </div>
        </section>

        <!-- Order History Section (Initially Hidden) -->
        <section id="order-history" class="hidden-section py-16 px-4">
            <h2 class="text-4xl font-bold text-center text-white mb-12">سفارشات من</h2>
            <div id="orders-container" class="max-w-4xl mx-auto space-y-6">
                <!-- Order history will be loaded here by JS -->
                <p id="no-orders-message" class="text-center text-gray-400 text-xl hidden">شما هیچ سفارشی ندارید.</p>
            </div>
        </section>

    </main>
    
    <!-- Footer -->
    <footer class="bg-[#111424] text-white text-center py-6">
        <p>&copy; 2024 PayPop MineShop. تمامی حقوق محفوظ است.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Data for demonstration
            let products = [
                { id: 1, name: 'رنک VIP', price: 50000, type: 'normal', description: 'دسترسی به تمامی امکانات اختصاصی سرور', plans: ['۱ ماهه', '۳ ماهه', 'نامحدود'], image: 'https://placehold.co/400x250/111424/A855F7?text=VIP_Rank' },
                { id: 2, name: 'رنک God', price: 90000, type: 'featured', description: 'قدرتمندترین رنک با بهترین قابلیت‌ها', plans: ['۱ ماهه', '۳ ماهه', 'نامحدود'], image: 'https://placehold.co/400x250/111424/7C3AED?text=God_Rank' },
                { id: 3, name: 'پول داخل بازی (۵۰ کا)', price: 20000, type: 'normal', description: 'خرید ارز سرور برای استفاده در بازی', plans: [], image: 'https://placehold.co/400x250/111424/A855F7?text=50k_Money' },
                { id: 4, name: 'رنک MVP', price: 75000, type: 'discounted', description: 'رنک ویژه با تخفیف محدود', plans: ['۱ ماهه', '۳ ماهه'], image: 'https://placehold.co/400x250/111424/7C3AED?text=MVP_Rank' },
                { id: 5, name: 'پول داخل بازی (۱۰۰ کا)', price: 35000, type: 'normal', description: 'خرید ارز سرور برای استفاده در بازی', plans: [], image: 'https://placehold.co/400x250/111424/A855F7?text=100k_Money' }
            ];

            // Simulated user data (for demo purposes only)
            const users = {
                'demoUser': { password: '123456', backupCode: 'ABC-123-XYZ' },
                'testUser': { password: 'testPass', backupCode: 'DEF-456-UVW' }
            };

            // Admin credentials (for demonstration purposes only)
            const ADMIN_USER = 'PayPopAdmin';
            const ADMIN_PASS = '@#PayPopShop1388';
            let ADMIN_CARD_NUMBER = '۱۲۳۴-۵۶۷۸-۹۱۰۱-۱۱۲۲';
            let DISCORD_URL = '#';
            let RUBIKA_URL = '#';

            // Shopping cart data
            let cartItems = [];
            let orders = [
                { id: 'ORD12345', minecraftUsername: 'demo_mc', username: 'demoUser', product: 'رنک VIP', price: 50000, date: '1403/01/15', status: 'تایید شده', receiptImage: 'https://placehold.co/200x150/0d0f1c/e0e7ff?text=Receipt_Image_1' },
                { id: 'ORD67890', minecraftUsername: 'test_mc', username: 'testUser', product: 'پول داخل بازی', price: 20000, date: '1403/01/10', status: 'در حال بررسی', receiptImage: 'https://placehold.co/200x150/0d0f1c/e0e7ff?text=Receipt_Image_2' }
            ];
            
            // Get DOM elements
            const allSections = ['login-register', 'admin-panel', 'products', 'shopping-cart', 'order-management', 'order-history'];
            
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const logoutLink = document.getElementById('logout-link');
            const logoutLinkMobile = document.getElementById('logout-link-mobile');
            const loginLink = document.getElementById('login-link');
            const registerLink = document.getElementById('register-link');
            const loginLinkMobile = document.getElementById('login-link-mobile');
            const registerLinkMobile = document.getElementById('register-link-mobile');
            const showRegisterLink = document.getElementById('show-register');
            const showLoginLink = document.getElementById('show-login');
            const showRecoveryLink = document.getElementById('show-recovery');
            const backToLoginLink = document.getElementById('back-to-login');
            const recoveryForm = document.getElementById('recovery-form');
            const navProductsLink = document.getElementById('nav-products-link');
            const navCartLink = document.getElementById('nav-cart-link');
            const navOrdersLink = document.getElementById('nav-orders-link');
            const navAdminLink = document.getElementById('nav-admin-link');
            const navProductsLinkMobile = document.getElementById('nav-products-link-mobile');
            const navCartLinkMobile = document.getElementById('nav-cart-link-mobile');
            const navOrdersLinkMobile = document.getElementById('nav-orders-link-mobile');
            const navAdminLinkMobile = document.getElementById('nav-admin-link-mobile');
            const priceFilter = document.getElementById('price-filter');
            const productsContainer = document.getElementById('products-container');
            const featuredContainer = document.getElementById('featured-products-container');
            const discountedContainer = document.getElementById('discounted-products-container');
            const addProductForm = document.getElementById('add-product-form');
            const cartContainer = document.getElementById('cart-container');
            const emptyCartMessage = document.getElementById('empty-cart-message');
            const totalPriceSpan = document.getElementById('total-price');
            const checkoutBtn = document.getElementById('checkout-btn');
            const orderForm = document.getElementById('order-form');
            const ordersContainer = document.getElementById('orders-container');
            const noOrdersMessage = document.getElementById('no-orders-message');
            const adminSettingsForm = document.getElementById('admin-settings-form');
            const adminCardNumberInput = document.getElementById('admin-card-number');
            const discordUrlInput = document.getElementById('discord-url');
            const rubikaUrlInput = document.getElementById('rubika-url');
            const discordLink = document.getElementById('discord-link');
            const rubikaLink = document.getElementById('rubika-link');
            const adminCardNumberDisplay = document.getElementById('admin-card-number-display');
            const finalPriceDisplay = document.getElementById('final-price');
            const productManagementContainer = document.getElementById('product-management-container');
            const adminOrdersContainer = document.getElementById('admin-orders-container');
            const currentUsernameElement = document.getElementById('current-username');
            const minecraftUsernameInput = document.getElementById('minecraft-username');


            // Initial State
            let isLoggedIn = false;
            let isAdmin = false;
            let currentUsername = null;

            // --- Helper Functions ---
            function generateRandomBackupCode() {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let code = '';
                for (let i = 0; i < 3; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                code += '-';
                for (let i = 0; i < 3; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                code += '-';
                for (let i = 0; i < 3; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return code;
            }
            
            function generateOrderId() {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let code = '';
                for (let i = 0; i < 9; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return `ORD${code}`;
            }

            // Function to show a specific section and hide others
            function showSection(sectionId) {
                allSections.forEach(id => {
                    const section = document.getElementById(id);
                    if (section) {
                        if (id === sectionId) {
                            section.classList.remove('hidden-section');
                            section.classList.add('visible-section');
                        } else {
                            section.classList.remove('visible-section');
                            section.classList.add('hidden-section');
                        }
                    }
                });
            }

            // Function to update nav links visibility based on user role
            function updateNavLinks() {
                const navLinks = [
                    navCartLink, navOrdersLink, navAdminLink,
                    navCartLinkMobile, navOrdersLinkMobile, navAdminLinkMobile,
                    loginLink, registerLink, loginLinkMobile, registerLinkMobile,
                    logoutLink, logoutLinkMobile
                ];
                
                navLinks.forEach(link => {
                    if (link) link.classList.add('hidden');
                });

                if (isAdmin) {
                    if (navAdminLink) navAdminLink.classList.remove('hidden');
                    if (navAdminLinkMobile) navAdminLinkMobile.classList.remove('hidden');
                    if (logoutLink) logoutLink.classList.remove('hidden');
                    if (logoutLinkMobile) logoutLinkMobile.classList.remove('hidden');
                } else if (isLoggedIn) {
                    if (navCartLink) navCartLink.classList.remove('hidden');
                    if (navOrdersLink) navOrdersLink.classList.remove('hidden');
                    if (navCartLinkMobile) navCartLinkMobile.classList.remove('hidden');
                    if (navOrdersLinkMobile) navOrdersLinkMobile.classList.remove('hidden');
                    if (logoutLink) logoutLink.classList.remove('hidden');
                    if (logoutLinkMobile) logoutLinkMobile.classList.remove('hidden');
                } else {
                    if (loginLink) loginLink.classList.remove('hidden');
                    if (registerLink) registerLink.classList.remove('hidden');
                    if (loginLinkMobile) loginLinkMobile.classList.remove('hidden');
                    if (registerLinkMobile) registerLinkMobile.classList.remove('hidden');
                }
                
                // Always show products link for logged-in users
                if (isLoggedIn && !isAdmin) {
                    if (navProductsLink) navProductsLink.classList.remove('hidden');
                    if (navProductsLinkMobile) navProductsLinkMobile.classList.remove('hidden');
                } else {
                    if (navProductsLink) navProductsLink.classList.add('hidden');
                    if (navProductsLinkMobile) navProductsLinkMobile.classList.add('hidden');
                }
            }

            function updateSocialLinks() {
                if (discordLink) discordLink.href = DISCORD_URL;
                if (rubikaLink) rubikaLink.href = RUBIKA_URL;
            }

            // --- Product Rendering & Filtering ---
            function renderProducts(productsToRender, container) {
                const productHTML = productsToRender.map(product => {
                    const plansHTML = product.plans.length > 0
                        ? `<h3 class="font-semibold text-white mb-2">پلن‌ها</h3>
                           <div class="flex flex-col space-y-2">
                               ${product.plans.map(plan => `
                                   <button class="bg-violet-700 hover:bg-violet-800 text-white font-semibold py-2 px-4 rounded-full transition-colors">
                                       پلن ${plan}
                                   </button>
                               `).join('')}
                           </div>`
                        : `<h3 class="font-semibold text-white mb-2">پلن‌ها</h3>
                           <p class="text-gray-400">این محصول پلن ندارد.</p>`;
                    
                    return `
                        <div class="card-bg p-6 rounded-3xl shadow-lg border-2 neon-border">
                            <img src="${product.image}" alt="${product.name}" class="rounded-2xl mb-4 w-full">
                            <div class="text-3xl font-bold text-violet-400">${product.name}</div>
                            <p class="mt-2 text-gray-400 text-sm">${product.description}</p>
                            <div class="text-4xl font-bold mt-4 text-white">
                                <span class="text-violet-300">${product.price.toLocaleString('fa-IR')} تومان</span>
                            </div>
                            <div class="mt-6">${plansHTML}</div>
                            <button class="btn-aurora text-white font-bold py-3 px-6 rounded-full mt-6 w-full add-to-cart-btn" data-product-id="${product.id}">
                                افزودن به سبد خرید
                            </button>
                        </div>
                    `;
                }).join('');
                container.innerHTML = productHTML;
            }

            function filterAndSortProducts(productsArray) {
                const filterValue = priceFilter.value;
                let sortedProducts = [...productsArray];

                if (filterValue === 'desc') {
                    sortedProducts.sort((a, b) => b.price - a.price);
                } else if (filterValue === 'asc') {
                    sortedProducts.sort((a, b) => a.price - b.price);
                }

                return sortedProducts;
            }

            function displayProducts() {
                const sortedProducts = filterAndSortProducts(products);
                const featuredProducts = sortedProducts.filter(p => p.type === 'featured');
                const discountedProducts = sortedProducts.filter(p => p.type === 'discounted');
                const allNormalProducts = sortedProducts.filter(p => p.type !== 'featured' && p.type !== 'discounted');
                
                renderProducts(featuredProducts, featuredContainer);
                renderProducts(discountedProducts, discountedContainer);
                renderProducts(allNormalProducts, productsContainer);
            }

            // --- Cart & Orders ---
            function renderCart() {
                cartContainer.innerHTML = '';
                if (cartItems.length === 0) {
                    emptyCartMessage.classList.remove('hidden');
                    checkoutBtn.classList.add('hidden');
                } else {
                    emptyCartMessage.classList.add('hidden');
                    checkoutBtn.classList.remove('hidden');
                    const cartHTML = cartItems.map(item => `
                        <div class="card-bg p-4 rounded-lg shadow-lg flex justify-between items-center">
                            <div class="flex items-center space-x-4 space-x-reverse">
                                <img src="${item.image}" alt="${item.name}" class="h-16 w-16 rounded-lg">
                                <div>
                                    <p class="text-xl font-bold text-white">${item.name}</p>
                                    <p class="text-violet-300">${item.price.toLocaleString('fa-IR')} تومان</p>
                                </div>
                            </div>
                            <button class="text-red-500 hover:text-red-400 transition-colors remove-from-cart-btn" data-product-id="${item.id}">
                                حذف
                            </button>
                        </div>
                    `).join('');
                    cartContainer.innerHTML = cartHTML;
                }
                const total = cartItems.reduce((sum, item) => sum + item.price, 0);
                totalPriceSpan.textContent = total.toLocaleString('fa-IR');
            }

            function renderOrders() {
                ordersContainer.innerHTML = '';
                const userOrders = orders.filter(o => o.username === currentUsername);
                if (userOrders.length === 0) {
                    noOrdersMessage.classList.remove('hidden');
                } else {
                    noOrdersMessage.classList.add('hidden');
                    const ordersHTML = userOrders.map(order => `
                        <div class="card-bg p-4 rounded-lg shadow-lg border-2 neon-border">
                            <div class="flex justify-between items-center">
                                <div class="flex-1">
                                    <p class="text-lg font-bold text-white">کد سفارش: ${order.id}</p>
                                    <p class="text-gray-400 mt-1">محصول: ${order.product}</p>
                                    <p class="text-gray-400">قیمت: ${order.price.toLocaleString('fa-IR')} تومان</p>
                                    <p class="text-gray-400">تاریخ: ${order.date}</p>
                                    <p class="text-gray-400">نام کاربری ماینکرافت: ${order.minecraftUsername}</p>
                                </div>
                                <div class="flex flex-col items-end space-y-2">
                                    <span class="px-4 py-1 rounded-full text-sm font-semibold ${order.status === 'تایید شده' ? 'bg-green-600' : 'bg-yellow-600'}">
                                        ${order.status}
                                    </span>
                                    ${order.status === 'در حال بررسی' ? `<button class="bg-red-600 hover:bg-red-700 text-white text-sm font-bold py-2 px-4 rounded-full transition-colors cancel-order-btn" data-order-id="${order.id}">
                                        لغو سفارش
                                    </button>` : ''}
                                </div>
                            </div>
                        </div>
                    `).join('');
                    ordersContainer.innerHTML = ordersHTML;
                }
            }
            
            function renderAdminProducts() {
                productManagementContainer.innerHTML = products.map(product => `
                    <div class="card-bg p-4 rounded-lg shadow-lg flex justify-between items-center">
                        <div class="flex items-center space-x-4 space-x-reverse">
                            <img src="${product.image}" alt="${product.name}" class="h-16 w-16 rounded-lg">
                            <div>
                                <p class="text-xl font-bold text-white">${product.name}</p>
                                <p class="text-violet-300">${product.price.toLocaleString('fa-IR')} تومان</p>
                            </div>
                        </div>
                        <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full delete-product-btn" data-product-id="${product.id}">
                            حذف
                        </button>
                    </div>
                `).join('');
            }

            function renderAdminOrders() {
                adminOrdersContainer.innerHTML = orders.map(order => `
                    <div class="card-bg p-4 rounded-lg shadow-lg border-2 neon-border">
                        <div class="flex flex-col md:flex-row justify-between items-center md:items-start">
                            <div class="flex-1 mb-4 md:mb-0">
                                <p class="text-lg font-bold text-white">کد سفارش: ${order.id}</p>
                                <p class="text-gray-400 mt-1">کاربر: ${order.username}</p>
                                <p class="text-gray-400">نام کاربری ماینکرافت: ${order.minecraftUsername}</p>
                                <p class="text-gray-400">محصول: ${order.product}</p>
                                <p class="text-gray-400">قیمت: ${order.price.toLocaleString('fa-IR')} تومان</p>
                                <p class="text-gray-400">تاریخ: ${order.date}</p>
                                <img src="${order.receiptImage}" alt="رسید پرداخت" class="w-48 h-auto mt-4 rounded-lg cursor-pointer" onclick="window.open(this.src)">
                            </div>
                            <div class="flex flex-col items-center md:items-end space-y-2">
                                <span class="px-4 py-1 rounded-full text-sm font-semibold ${order.status === 'تایید شده' ? 'bg-green-600' : order.status === 'رد شده' ? 'bg-red-600' : 'bg-yellow-600'}">
                                    ${order.status}
                                </span>
                                ${order.status === 'در حال بررسی' ? `
                                <div class="flex space-x-2 space-x-reverse">
                                    <button class="bg-green-600 hover:bg-green-700 text-white text-sm font-bold py-2 px-4 rounded-full approve-order-btn" data-order-id="${order.id}">
                                        تایید
                                    </button>
                                    <button class="bg-red-600 hover:bg-red-700 text-white text-sm font-bold py-2 px-4 rounded-full reject-order-btn" data-order-id="${order.id}">
                                        رد
                                    </button>
                                </div>` : ''}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            // --- Show/Hide Sections ---
            function showLoginForms() {
                document.getElementById('login-form-card').classList.remove('hidden');
                document.getElementById('register-form-card').classList.add('hidden');
                document.getElementById('recovery-form-card').classList.add('hidden');
                 showSection('login-register');
            }
            
            function showLoggedInContent() {
                if (isAdmin) {
                    showSection('admin-panel');
                    if (adminCardNumberInput) adminCardNumberInput.value = ADMIN_CARD_NUMBER;
                    if (discordUrlInput) discordUrlInput.value = DISCORD_URL;
                    if (rubikaUrlInput) rubikaUrlInput.value = RUBIKA_URL;
                    renderAdminProducts();
                    renderAdminOrders();
                } else {
                    showSection('products');
                    displayProducts();
                    renderCart();
                    renderOrders();
                }
            }

            // --- Event Listeners ---
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('open');
            });

            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('username-login').value;
                const password = document.getElementById('password-login').value;
                
                if (username === ADMIN_USER && password === ADMIN_PASS) {
                    alert('ادمین عزیز، خوش آمدید!');
                    isAdmin = true;
                    isLoggedIn = true;
                    currentUsername = username;
                } else if (users[username] && users[username].password === password) {
                    alert('ورود با موفقیت انجام شد!');
                    isAdmin = false;
                    isLoggedIn = true;
                    currentUsername = username;
                } else if (users[username]) {
                    alert('رمز عبور شما اشتباه است!');
                    return;
                } else {
                    alert('نام کاربری یافت نشد.');
                    return;
                }
                updateNavLinks();
                showLoggedInContent();
            });

            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('username-register').value;
                const password = document.getElementById('password-register').value;

                if (users[username]) {
                    alert('این نام کاربری قبلاً ثبت شده است!');
                    return;
                }
                
                const backupCode = generateRandomBackupCode();
                users[username] = { password, backupCode };
                alert(`ثبت نام با موفقیت انجام شد! کد پشتیبان شما: ${backupCode}. لطفا آن را ذخیره کنید.`);
                document.getElementById('register-form-card').classList.add('hidden');
                document.getElementById('login-form-card').classList.remove('hidden');
            });

            recoveryForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('username-recovery').value;
                const backupCode = document.getElementById('backup-code').value;
                const newPassword = document.getElementById('new-password').value;
                
                if (users[username] && users[username].backupCode === backupCode) {
                    users[username].password = newPassword;
                    alert('رمز عبور شما با موفقیت تغییر کرد!');
                    showLoginForms();
                } else {
                    alert('نام کاربری یا کد پشتیبان اشتباه است!');
                }
            });

            logoutLink.addEventListener('click', (e) => {
                e.preventDefault();
                isLoggedIn = false;
                isAdmin = false;
                currentUsername = null;
                updateNavLinks();
                showLoginForms();
            });

            if (logoutLinkMobile) {
                logoutLinkMobile.addEventListener('click', (e) => {
                    e.preventDefault();
                    isLoggedIn = false;
                    isAdmin = false;
                    currentUsername = null;
                    mobileMenu.classList.remove('open');
                    updateNavLinks();
                    showLoginForms();
                });
            }
            
            showRegisterLink.addEventListener('click', (e) => {
                e.preventDefault();
                document.getElementById('login-form-card').classList.add('hidden');
                document.getElementById('register-form-card').classList.remove('hidden');
                document.getElementById('recovery-form-card').classList.add('hidden');
            });

            showLoginLink.addEventListener('click', (e) => {
                e.preventDefault();
                document.getElementById('login-form-card').classList.remove('hidden');
                document.getElementById('register-form-card').classList.add('hidden');
                document.getElementById('recovery-form-card').classList.add('hidden');
            });

            showRecoveryLink.addEventListener('click', (e) => {
                 e.preventDefault();
                document.getElementById('login-form-card').classList.add('hidden');
                document.getElementById('register-form-card').classList.add('hidden');
                document.getElementById('recovery-form-card').classList.remove('hidden');
            });
            
            backToLoginLink.addEventListener('click', (e) => {
                 e.preventDefault();
                document.getElementById('login-form-card').classList.remove('hidden');
                document.getElementById('register-form-card').classList.add('hidden');
                document.getElementById('recovery-form-card').classList.add('hidden');
            });


            // Nav links for content sections
            const navLinks = {
                'nav-products-link': 'products',
                'nav-products-link-mobile': 'products',
                'nav-cart-link': 'shopping-cart',
                'nav-cart-link-mobile': 'shopping-cart',
                'nav-orders-link': 'order-history',
                'nav-orders-link-mobile': 'order-history',
                'nav-admin-link': 'admin-panel',
                'nav-admin-link-mobile': 'admin-panel'
            };

            Object.keys(navLinks).forEach(id => {
                const link = document.getElementById(id);
                if (link) {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        showSection(navLinks[id]);
                        if (mobileMenu.classList.contains('open')) {
                            mobileMenu.classList.remove('open');
                        }
                    });
                }
            });

            priceFilter.addEventListener('change', () => {
                displayProducts();
            });

            // Add product to cart handler
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('add-to-cart-btn')) {
                    const productId = e.target.getAttribute('data-product-id');
                    const productToAdd = products.find(p => p.id == productId);
                    if (productToAdd) {
                        cartItems.push(productToAdd);
                        renderCart();
                        alert(`${productToAdd.name} به سبد خرید اضافه شد!`);
                    }
                }
            });

            // Remove product from cart handler
            cartContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-from-cart-btn')) {
                    const productId = e.target.getAttribute('data-product-id');
                    const itemIndex = cartItems.findIndex(item => item.id == productId);
                    if (itemIndex > -1) {
                        cartItems.splice(itemIndex, 1);
                        renderCart();
                    }
                }
            });

            // Order cancellation handler for users
            ordersContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('cancel-order-btn')) {
                    const orderId = e.target.getAttribute('data-order-id');
                    const orderIndex = orders.findIndex(order => order.id === orderId);
                    if (orderIndex > -1) {
                        orders[orderIndex].status = 'لغو شده';
                        renderOrders();
                        alert(`سفارش با کد ${orderId} لغو شد.`);
                    }
                }
            });

            // Admin: Delete product handler
            productManagementContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('delete-product-btn')) {
                    const productId = e.target.getAttribute('data-product-id');
                    const productIndex = products.findIndex(p => p.id == productId);
                    if (productIndex > -1) {
                        products.splice(productIndex, 1);
                        alert('محصول با موفقیت حذف شد.');
                        renderAdminProducts();
                        displayProducts();
                    }
                }
            });
            
            // Admin: Order management handlers
            adminOrdersContainer.addEventListener('click', (e) => {
                const orderId = e.target.getAttribute('data-order-id');
                const orderIndex = orders.findIndex(o => o.id === orderId);
                if (orderIndex > -1) {
                    if (e.target.classList.contains('approve-order-btn')) {
                        orders[orderIndex].status = 'تایید شده';
                        alert(`سفارش با کد ${orderId} تایید شد.`);
                        renderAdminOrders();
                        renderOrders(); // Refresh user view
                    } else if (e.target.classList.contains('reject-order-btn')) {
                        orders[orderIndex].status = 'رد شده';
                        alert(`سفارش با کد ${orderId} رد شد.`);
                        renderAdminOrders();
                        renderOrders(); // Refresh user view
                    }
                }
            });
            
            // Checkout button handler
            checkoutBtn.addEventListener('click', () => {
                 showSection('order-management');
                 const total = cartItems.reduce((sum, item) => sum + item.price, 0);
                 if (finalPriceDisplay) {
                     finalPriceDisplay.textContent = total.toLocaleString('fa-IR');
                 }
                 if (adminCardNumberDisplay) {
                     adminCardNumberDisplay.textContent = `شماره کارت ادمین: ${ADMIN_CARD_NUMBER}`;
                 }
            });
            
            // Add product via admin panel handler
            addProductForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newProduct = {
                    id: products.length + 1,
                    name: document.getElementById('product-name').value,
                    price: parseInt(document.getElementById('product-price').value),
                    image: document.getElementById('product-image').value,
                    type: document.getElementById('product-type').value,
                    description: document.getElementById('product-description').value,
                    plans: document.getElementById('product-plans').value.split(',').map(p => p.trim()).filter(p => p.length > 0)
                };
                products.push(newProduct);
                alert(`محصول "${newProduct.name}" با موفقیت اضافه شد!`);
                addProductForm.reset();
                renderAdminProducts(); // Refresh admin product list
                displayProducts(); // Refresh user product list
            });

            // Order form handler
            orderForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const newOrder = {
                    id: generateOrderId(),
                    username: currentUsername, // Use the currently logged in user
                    minecraftUsername: document.getElementById('minecraft-username').value,
                    product: cartItems.map(item => item.name).join(', '),
                    price: cartItems.reduce((sum, item) => sum + item.price, 0),
                    date: new Date().toLocaleDateString('fa-IR'),
                    status: 'در حال بررسی',
                    receiptImage: document.getElementById('receipt-image').files.length > 0 ? 'https://placehold.co/200x150/0d0f1c/e0e7ff?text=Uploaded_Receipt' : 'https://placehold.co/200x150/0d0f1c/e0e7ff?text=No_Receipt'
                };
                
                orders.push(newOrder);
                alert(`سفارش شما با کد ${newOrder.id} با موفقیت ثبت شد.`);
                cartItems = []; // Clear cart after order
                renderCart();
                renderOrders(); // Refresh user order history
                showSection('order-history');
                orderForm.reset();
            });

            // Admin settings form handler
            if (adminSettingsForm) {
                adminSettingsForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const newCardNumber = adminCardNumberInput.value;
                    const newDiscordUrl = discordUrlInput.value;
                    const newRubikaUrl = rubikaUrlInput.value;
                    
                    ADMIN_CARD_NUMBER = newCardNumber;
                    DISCORD_URL = newDiscordUrl;
                    RUBIKA_URL = newRubikaUrl;
                    
                    updateSocialLinks();
                    alert('تنظیمات با موفقیت بهروزرسانی شد!');
                });
            }

            // Initial render
            updateSocialLinks();
            updateNavLinks();
            showLoginForms();
        });
    </script>
</body>
</html>
